title: 树莓派折腾之旅（二）
categories: 树莓派
date: 2015-06-06
tags: 树莓派
---

######昨天说到了GPIO口的配置，今天有空就再说一说摄像头吧。

######我是参考的这个帖子做的

[http://www.shumeipai.net/forum.php?mod=viewthread&tid=18882](http://www.shumeipai.net/forum.php?mod=viewthread&tid=18882)

插上摄像头可以看见usbvideo0.

接下来安装

    sudo apt-get install subversion
    
    sudo apt-get install libv4l-dev
    
    sudo apt-get install libjpeg8-dev
    
    sudo apt-get install imagemagick


<!--more-->



到上面这些步骤都没有错。

下面下载的是`mipg-steamer`软件，编译并安装。

那个帖子里面的下载地址都过期了，所以我就重新百度 google找啊找。

在网上搜`mjpg-streamer`搜出一个mjpg-streamer-r63，这个包始终编译不成功，有郁闷了很久。

终于在github上面有一个和帖子说的一样的。

还有在这里也有一个链接[http://pan.baidu.com/share/link?shareid=507341537&uk=84253138](http://pan.baidu.com/share/link?shareid=507341537&uk=84253138)

于是希望重新燃起，

开始编译，建立软连接：`sudo ln -s /usr/include/libv4l1-videodev.h /usr/include/linux/videodev.h`

进入目录并编译：
    
    cd mjpg-streamer
    make USE_LIBV4L2=true clean all

编译好像是成功了，因为没有报错。

然后执行 `sudo  ./start.sh`

打开浏览器访问，树莓派ip地址:`8080`

发现并没有成功，摄像头并没有出来，多么痛的领悟啊。

很忧桑有木有。

于是又开始找问题，

分析得出以下结论：

摄像头没有打开，但是这不科学啊，设备可以检查到usbvideo0。

摄像头驱动问题，我把摄像头放到windows下发现可以使用。

就是环境问题咯。

所以我一个一个尝试，首先看用摄像头拍照可以不。

结果发现摄像头没有问题。

就是拍出来的照片有点失真。图片如下：

![](http://imglf0.ph.126.net/kvnPMluEeM1YSALtPk3uBg==/6630796186327897140.jpg)
然后又各种找资料。

找到一个用motion软件做的摄像头识别。好像是专门的网络摄像头监控软件。

嘿嘿，希望还是有的。

    sudo apt-get install motion 

配置motion，编辑motion.conf文件
    sudo vi /etc/motion/motion.conf

找到”control_localhost on “和”webcam_localhost on“这两行，改为以下两行后，保存退出
    control_localhost off
    webcam_localhost off

运行motion软件，输入`motion -n`

在pc上用浏览器打开 树莓派ip地址:8080

经过我的测试 ie11  和chrome 不可以实现，火狐浏览器可以哦

![](http://imglf1.ph.126.net/HGjYV7U08iEfU8aLBA2PyQ==/2834453015494321729.jpg)
画面就是上面的这样子咯。

昨天弄了一天效果还可以，感觉很满意。

总结一下吧：

树莓派和以前玩过全志A20差不多，都是烧入操作系统。

直接上操作系统，因为有过这方面的经验，所以折腾起来也就不费事了。

摄像头监控还做的不好，有时间再玩一玩，可能是因为昨天折腾了一天，头很晕，所以后面摄像头的思路不是很清晰。

等暑假再做个wifi小车玩一玩。嘿嘿~~！

还有就是最近的微信公众号效果不错，800多粉丝了。

这几天查成绩功能不可用，还是很不爽的，所以就传了2个游戏让大家玩。

嘿嘿，另外发现小米路由器还是很坑的。

星期五服务器莫名其妙的无法访问，使用的云监控没有报警，原因很奇怪，后来发现是小米路由器不知道什么时候自己把硬盘自动休眠给开启了。害的我找了半天，还以为是网络问题呢。结果把小米路由器的硬盘休眠功能一关闭，服务器就不挂了，正常运行了一天。等查成绩功能教务系统开放了再看一看效果。实在不行就用树莓派当web服务器了。刷个openwrt玩一玩。

